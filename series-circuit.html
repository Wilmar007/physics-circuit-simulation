<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Series Circuit Electron Flow Simulator</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html, body {
      height: 100%;
      width: 100%;
    }

    body {
      font-family: 'Rajdhani', 'Orbitron', -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(135deg, #050814 0%, #0b0f2a 50%, #060a18 100%);
      color: #e8eef7;
      overflow-x: hidden;
    }

    .main-wrapper {
      width: 100%;
      min-height: 100%;
      display: flex;
      flex-direction: column;
      padding: 32px;
      overflow-y: auto;
    }

    .header-section {
      margin-bottom: 0;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 20px;
    }

    .header-content {
      flex: 1;
    }

    .page-title {
      font-size: 32px;
      font-weight: 700;
      color: #00d9ff;
      letter-spacing: 1px;
      margin-bottom: 8px;
      text-shadow: 0 0 25px rgba(0, 217, 255, 0.9), 0 0 50px rgba(0, 217, 255, 0.5);
    }

    .caption {
      font-size: 16px;
      color: #a8b9d4;
      line-height: 1.6;
      max-width: 680px;
    }

    .mode-toggle-container {
      flex-shrink: 0;
      display: flex;
      gap: 12px;
    }

    .collapsible-content {
      transition: max-height 0.4s ease, opacity 0.3s ease, margin 0.4s ease;
      overflow: hidden;
    }

    .collapsible-content.collapsed {
      max-height: 0 !important;
      opacity: 0;
      margin-top: 0 !important;
      margin-bottom: 0 !important;
    }

    .simulator-area {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 600px;
      margin-bottom: 8px;
    }

    .controls-panel.collapsible-content {
      margin-bottom: 40px;
    }

    .discussion-sections.collapsible-content {
      margin-top: 0;
    }

    .mode-toggle-btn {
      background: linear-gradient(135deg, rgba(0, 217, 255, 0.2), rgba(0, 217, 255, 0.08));
      border: 2px solid rgba(0, 217, 255, 0.7);
      border-radius: 10px;
      padding: 14px 28px;
      color: #00d9ff;
      font-size: 17px;
      font-weight: 700;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: all 0.3s ease;
      box-shadow: 0 0 35px rgba(0, 217, 255, 0.5), 0 0 60px rgba(0, 217, 255, 0.25);
      font-family: 'Rajdhani', 'Orbitron', -apple-system, BlinkMacSystemFont, sans-serif;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .mode-toggle-btn:hover {
      background: linear-gradient(135deg, rgba(0, 217, 255, 0.3), rgba(0, 217, 255, 0.15));
      box-shadow: 0 0 50px rgba(0, 217, 255, 0.7), 0 0 90px rgba(0, 217, 255, 0.4);
      transform: translateY(-2px);
    }

    #mode-icon {
      font-size: 22px;
    }

    .circuit-container {
      position: relative;
      width: 100%;
      max-width: 1200px;
      height: 650px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .circuit-svg {
      width: 100%;
      height: 100%;
    }

    .wire-line {
      stroke: #5a7aa0;
      stroke-width: 8;
      fill: none;
      filter: drop-shadow(0 0 8px rgba(90, 122, 160, 0.6));
    }

    .electron-dot {
      fill: #00d9ff;
      filter: drop-shadow(0 0 12px rgba(0, 217, 255, 1)) drop-shadow(0 0 24px rgba(0, 217, 255, 0.6));
    }

    .battery-box {
      fill: none;
      stroke: #e8eef7;
      stroke-width: 2;
      filter: drop-shadow(0 0 6px rgba(232, 238, 247, 0.4));
    }

    .battery-pos {
      stroke: #ff4444;
      stroke-width: 3.5;
      filter: drop-shadow(0 0 8px rgba(255, 68, 68, 0.8));
    }

    .battery-neg {
      stroke: #5a7aa0;
      stroke-width: 3.5;
      filter: drop-shadow(0 0 6px rgba(90, 122, 160, 0.6));
    }

    .resistor-rect {
      stroke: #e8eef7;
      stroke-width: 2;
      fill: #1a2338;
      filter: drop-shadow(0 0 6px rgba(232, 238, 247, 0.3));
    }

    .resistor-zigzag {
      stroke: #ffd700;
      stroke-width: 2.5;
      fill: none;
      filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.8)) drop-shadow(0 0 20px rgba(255, 215, 0, 0.4));
    }

    .component-label {
      fill: #a8b9d4;
      font-size: 14px;
      font-weight: 500;
    }

    .controls-panel {
      width: 100%;
      max-width: 1200px;
      background: linear-gradient(135deg, rgba(10, 15, 35, 0.8), rgba(5, 8, 20, 0.9));
      border: 2px solid rgba(0, 217, 255, 0.5);
      border-radius: 14px;
      padding: 40px;
      backdrop-filter: blur(12px);
      margin: 0 auto;
      box-shadow: 0 0 50px rgba(0, 217, 255, 0.4), 0 0 80px rgba(0, 217, 255, 0.2), inset 0 0 40px rgba(0, 217, 255, 0.08);
    }

    .control-row {
      margin-bottom: 16px;
    }

    .control-row:last-child {
      margin-bottom: 0;
    }

    .control-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .control-label {
      font-size: 16px;
      font-weight: 600;
      color: #a8b9d4;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .control-value {
      font-size: 18px;
      font-weight: 700;
      color: #00d9ff;
      min-width: 80px;
      text-align: right;
      text-shadow: 0 0 12px rgba(0, 217, 255, 0.7);
    }

    .slider-control {
      width: 100%;
      height: 14px;
      border-radius: 7px;
      background: rgba(90, 122, 160, 0.3);
      outline: none;
      appearance: none;
      cursor: pointer;
      transition: background 0.2s, box-shadow 0.2s;
      border: 2px solid rgba(0, 217, 255, 0.5);
      box-shadow: 0 0 12px rgba(0, 217, 255, 0.25);
    }

    .slider-control:hover {
      background: rgba(90, 122, 160, 0.5);
      border-color: rgba(0, 217, 255, 0.7);
    }

    .slider-control::-webkit-slider-thumb {
      appearance: none;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: linear-gradient(135deg, #00d9ff, #00a8cc);
      box-shadow: 0 0 18px rgba(0, 217, 255, 0.9), 0 0 35px rgba(0, 217, 255, 0.5);
      cursor: pointer;
      transition: transform 0.15s;
      border: 3px solid #ffffff;
    }

    .slider-control::-webkit-slider-thumb:hover {
      transform: scale(1.25);
      box-shadow: 0 0 25px rgba(0, 217, 255, 1), 0 0 45px rgba(0, 217, 255, 0.7);
    }

    .slider-control::-moz-range-thumb {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: linear-gradient(135deg, #00d9ff, #00a8cc);
      box-shadow: 0 0 18px rgba(0, 217, 255, 0.9), 0 0 35px rgba(0, 217, 255, 0.5);
      cursor: pointer;
      border: 3px solid #ffffff;
      transition: transform 0.15s;
    }

    .slider-control::-moz-range-thumb:hover {
      transform: scale(1.25);
      box-shadow: 0 0 25px rgba(0, 217, 255, 1), 0 0 45px rgba(0, 217, 255, 0.7);
    }

    .current-readout {
      margin-top: 22px;
      padding: 18px;
      background: linear-gradient(135deg, rgba(0, 217, 255, 0.15), rgba(0, 217, 255, 0.08));
      border: 2px solid rgba(0, 217, 255, 0.6);
      border-radius: 10px;
      text-align: center;
      box-shadow: 0 0 40px rgba(0, 217, 255, 0.4), 0 0 70px rgba(0, 217, 255, 0.2), inset 0 0 30px rgba(0, 217, 255, 0.15);
    }

    .current-label-text {
      font-size: 14px;
      color: #a8b9d4;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .current-value-display {
      font-size: 30px;
      font-weight: 700;
      color: #00d9ff;
      letter-spacing: 1px;
      text-shadow: 0 0 18px rgba(0, 217, 255, 0.9), 0 0 35px rgba(0, 217, 255, 0.5);
    }

    .discussion-sections {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto 40px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .discussion-card {
      background: linear-gradient(135deg, rgba(10, 15, 35, 0.7), rgba(5, 8, 20, 0.85));
      border: 2px solid rgba(0, 217, 255, 0.4);
      border-radius: 12px;
      backdrop-filter: blur(10px);
      overflow: hidden;
      box-shadow: 0 0 35px rgba(0, 217, 255, 0.3), 0 0 60px rgba(0, 217, 255, 0.15);
    }

    .discussion-toggle {
      width: 100%;
      background: transparent;
      border: none;
      padding: 18px 24px;
      display: flex;
      align-items: center;
      gap: 12px;
      cursor: pointer;
      transition: background 0.2s;
      color: #e8eef7;
    }

    .discussion-toggle:hover {
      background: rgba(0, 217, 255, 0.1);
    }

    .toggle-icon {
      font-size: 14px;
      color: #00d9ff;
      transition: transform 0.3s;
      display: inline-block;
      min-width: 16px;
    }

    .toggle-icon.rotated {
      transform: rotate(90deg);
    }

    .discussion-title {
      font-size: 18px;
      font-weight: 600;
      color: #e8eef7;
      text-shadow: 0 0 10px rgba(232, 238, 247, 0.3);
    }

    .discussion-content {
      padding: 0 24px 24px 52px;
      color: #a8b9d4;
      line-height: 1.7;
      font-size: 15px;
    }

    .discussion-content p {
      margin-bottom: 14px;
    }

    .discussion-content ul {
      margin: 10px 0;
      padding-left: 20px;
    }

    .discussion-content li {
      margin-bottom: 8px;
    }

    .discussion-content strong {
      color: #e8eef7;
      font-weight: 600;
    }

    .formula-box {
      background: linear-gradient(135deg, rgba(0, 217, 255, 0.18), rgba(0, 217, 255, 0.12));
      border: 2px solid rgba(0, 217, 255, 0.7);
      border-radius: 10px;
      padding: 18px;
      text-align: center;
      font-size: 26px;
      font-weight: 700;
      color: #00d9ff;
      margin: 16px 0;
      font-family: 'Courier New', monospace;
      letter-spacing: 2px;
      box-shadow: 0 0 45px rgba(0, 217, 255, 0.5), 0 0 80px rgba(0, 217, 255, 0.3), inset 0 0 35px rgba(0, 217, 255, 0.2);
      text-shadow: 0 0 25px rgba(0, 217, 255, 1), 0 0 50px rgba(0, 217, 255, 0.6);
    }

    /* Real Objects Mode Styles */
    .real-battery-box {
      fill: #1a1a1a;
      stroke: #333;
      stroke-width: 2;
      filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.5));
    }

    .real-battery-terminal {
      fill: #c0c0c0;
      stroke: #888;
      stroke-width: 1;
    }

    .real-battery-label {
      fill: #ffffff;
      font-size: 14px;
      font-weight: 700;
    }

    .real-battery-stripe {
      fill: #d32f2f;
      stroke: none;
    }

    .real-resistor-body {
      fill: #d4a574;
      stroke: #8b6f47;
      stroke-width: 2;
      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.4));
    }

    .real-resistor-band {
      stroke-width: 3;
    }

    .real-resistor-lead {
      stroke: #c0c0c0;
      stroke-width: 3;
      fill: none;
    }

    .real-wire {
      stroke: #e53935;
      stroke-width: 10;
      fill: none;
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
    }

    .real-wire-black {
      stroke: #212121;
    }

    .real-switch-body {
      fill: #263238;
      stroke: #37474f;
      stroke-width: 2;
      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.4));
    }

    .real-switch-lever {
      stroke: #c0c0c0;
      stroke-width: 5;
      stroke-linecap: round;
    }

    .real-switch-terminal {
      fill: #c0c0c0;
      stroke: #888;
      stroke-width: 1;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="main-wrapper">
   <div class="header-section">
    <div class="header-content">
     <h1 class="page-title" id="page-title">üîå Series Circuit: How Current Flows</h1>
     <p class="caption" id="caption-text">In a series circuit, electrons flow through a single closed path. Changing voltage and resistance affects how fast they move.</p>
    </div>
    <div class="mode-toggle-container"><button class="mode-toggle-btn" id="mode-toggle"> <span id="mode-icon">üîß</span> <span id="mode-text">Real Objects Mode</span> </button> <button class="mode-toggle-btn" id="visibility-toggle"> <span>üëÅÔ∏è</span> <span id="visibility-text">Hide All</span> </button>
    </div>
   </div>
   <div class="simulator-area collapsible-content" id="simulator-section">
    <div class="circuit-container">
     <svg class="circuit-svg" id="main-svg" viewbox="0 0 900 600" xmlns="http://www.w3.org/2000/svg">
     </svg>
    </div>
   </div>
   <div class="controls-panel collapsible-content" id="controls-section">
    <div class="control-row">
     <div class="control-header"><label for="voltage-slider" class="control-label" id="voltage-label">Voltage (V)</label> <span class="control-value" id="voltage-display">6.0 V</span>
     </div><input type="range" id="voltage-slider" class="slider-control" min="1" max="12" step="0.5" value="6">
    </div>
    <div class="control-row">
     <div class="control-header"><label for="resistance-slider" class="control-label" id="resistance-label">Resistance (Œ©)</label> <span class="control-value" id="resistance-display">3.0 Œ©</span>
     </div><input type="range" id="resistance-slider" class="slider-control" min="1" max="10" step="0.5" value="3">
    </div>
    <div class="current-readout">
     <div class="current-label-text">
      Current (I = V / R)
     </div>
     <div class="current-value-display" id="current-display">
      2.00 A
     </div>
    </div>
   </div>
   <div class="discussion-sections collapsible-content" id="discussion-sections"><!-- Section 1: What is a Series Circuit? -->
    <div class="discussion-card"><button class="discussion-toggle" onclick="toggleSection('section1')"> <span class="toggle-icon" id="icon-section1">‚ñ∂</span> <span class="discussion-title">üîó What is a Series Circuit?</span> </button>
     <div class="discussion-content" id="section1" style="display: none;">
      <p>A series circuit is a circuit where components are connected end-to-end in a single continuous path. There is only ONE route for electrons to flow from the battery, through all components, and back to the battery.</p>
      <p><strong>Key Features of Series Circuits:</strong></p>
      <ul>
       <li><strong>Single Path:</strong> Electrons must travel through every component in the circuit‚Äîthere are no alternative routes</li>
       <li><strong>Same Current Everywhere:</strong> The current (I) is identical at every point in the circuit. If 2A flows through the battery, 2A flows through the resistor and switch</li>
       <li><strong>If One Breaks, All Stop:</strong> Opening the switch or removing any component breaks the entire circuit and stops all current flow</li>
      </ul>
     </div>
    </div><!-- Section 2: Current in Series Circuits -->
    <div class="discussion-card"><button class="discussion-toggle" onclick="toggleSection('section2')"> <span class="toggle-icon" id="icon-section2">‚ñ∂</span> <span class="discussion-title">‚ö° How Current Flows in Series Circuits</span> </button>
     <div class="discussion-content" id="section2" style="display: none;">
      <p>In a series circuit, current is the same everywhere because electrons have only one path to follow. Think of it like water flowing through a single pipe‚Äîthe flow rate is the same at every point.</p>
      <div class="formula-box">
       I = V / R
      </div>
      <p><strong>What You See in This Simulation:</strong></p>
      <ul>
       <li>The glowing dots represent electrons flowing in a continuous loop</li>
       <li>All electrons move at the same speed throughout the entire circuit</li>
       <li>Increasing voltage makes electrons flow faster (higher current)</li>
       <li>Increasing resistance slows down electron flow (lower current)</li>
      </ul>
      <p><strong>Try it:</strong> Adjust the voltage and resistance sliders to see how current changes!</p>
     </div>
    </div><!-- Section 3: Switches in Series Circuits -->
    <div class="discussion-card"><button class="discussion-toggle" onclick="toggleSection('section3')"> <span class="toggle-icon" id="icon-section3">‚ñ∂</span> <span class="discussion-title">üîò The Switch Breaks the Series Path</span> </button>
     <div class="discussion-content" id="section3" style="display: none;">
      <p>In a series circuit, a switch controls the entire circuit because it breaks or completes the single path that electrons must follow.</p>
      <p><strong>Switch ON (closed):</strong></p>
      <ul>
       <li>The circuit forms a complete loop</li>
       <li>Current flows continuously through all components</li>
       <li>All electrons follow the same path around the circuit</li>
      </ul>
      <p><strong>Switch OFF (open):</strong></p>
      <ul>
       <li>The single path is broken‚Äîthere's a gap in the circuit</li>
       <li>Electrons cannot jump across the gap</li>
       <li>Current drops to zero everywhere in the circuit instantly</li>
      </ul>
      <p><strong>Try it:</strong> Click the switch to see the entire circuit stop working when the series path is broken!</p>
     </div>
    </div><!-- Section 4: Real-World Series Circuit Examples -->
    <div class="discussion-card"><button class="discussion-toggle" onclick="toggleSection('section4')"> <span class="toggle-icon" id="icon-section4">‚ñ∂</span> <span class="discussion-title">üí° Series Circuits in Real Life</span> </button>
     <div class="discussion-content" id="section4" style="display: none;">
      <p>Series circuits are used when you want one switch to control multiple devices, or when you need the same current through all components.</p>
      <p><strong>Common Examples:</strong></p>
      <ul>
       <li><strong>Old Christmas Lights:</strong> All bulbs connected in series‚Äîif one breaks, the whole string goes dark because the series path is broken</li>
       <li><strong>Flashlights:</strong> Battery, switch, and bulb in series‚Äîthe switch controls whether current can flow through the single path</li>
       <li><strong>Safety Switches:</strong> Emergency stop buttons in series ensure that opening any one switch stops the entire system</li>
       <li><strong>Battery Stacks:</strong> Multiple batteries in series add their voltages together to power higher-voltage devices</li>
      </ul>
      <p><strong>Limitation:</strong> In a series circuit, adding more resistors increases total resistance and reduces current through the entire circuit.</p>
     </div>
    </div>
   </div>
  </div>
  <script>
    const defaultConfig = {
      page_title: "üîå Series Circuit: How Current Flows",
      caption_text: "In a series circuit, electrons flow through a single closed path. Changing voltage and resistance affects how fast they move.",
      voltage_label_text: "Voltage (V)",
      resistance_label_text: "Resistance (Œ©)",
      background_color: "#050814",
      primary_accent_color: "#00d9ff",
      wire_color: "#5a7aa0",
      text_color: "#e8eef7",
      secondary_text_color: "#a8b9d4"
    };

    let voltage = 6.0;
    let resistance = 3.0;
    const electronCount = 14;
    let circuitOn = true;
    let isRealMode = false;

    function calculateCurrent() {
      return voltage / resistance;
    }

    function getElectronSpeed() {
      const current = calculateCurrent();
      const baseDuration = 4.0;
      return baseDuration / (current / 2.0);
    }

    function updateDisplayValues() {
      const current = calculateCurrent();
      document.getElementById('voltage-display').textContent = `${voltage.toFixed(1)} V`;
      document.getElementById('resistance-display').textContent = `${resistance.toFixed(1)} Œ©`;
      document.getElementById('current-display').textContent = `${current.toFixed(2)} A`;
    }

    function renderCircuit() {
      const svg = document.getElementById('main-svg');
      
      if (isRealMode) {
        svg.innerHTML = `
          <defs>
            <path id="electron-path" d="M 100 320 L 100 400 L 350 400 L 350 460 L 450 460 L 450 400 L 800 400 L 800 260 L 800 140 L 800 100 L 550 100 L 320 100 L 100 100 L 100 250 Z" />
            <radialGradient id="bulb-glow">
              <stop offset="0%" style="stop-color:#ffeb3b;stop-opacity:0.9" />
              <stop offset="50%" style="stop-color:#ffc107;stop-opacity:0.6" />
              <stop offset="100%" style="stop-color:#ff9800;stop-opacity:0" />
            </radialGradient>
          </defs>

          <line class="real-wire" x1="100" y1="400" x2="350" y2="400" />
          <line class="real-wire" x1="450" y1="400" x2="800" y2="400" />
          <line class="real-wire" x1="350" y1="400" x2="350" y2="460" />
          <line class="real-wire" x1="350" y1="460" x2="450" y2="460" />
          <line class="real-wire" x1="450" y1="460" x2="450" y2="400" />
          <line class="real-wire" x1="800" y1="400" x2="800" y2="260" />
          <line class="real-wire real-wire-black" x1="800" y1="140" x2="800" y2="100" />
          <line class="real-wire real-wire-black" x1="800" y1="100" x2="100" y2="100" />
          <line class="real-wire real-wire-black" x1="100" y1="100" x2="100" y2="250" />
          <line class="real-wire" x1="100" y1="320" x2="100" y2="400" />

          <g transform="translate(60, 250)">
            <rect class="real-battery-box" x="0" y="0" width="80" height="70" rx="5" />
            <rect class="real-battery-stripe" x="0" y="10" width="80" height="15" />
            <text class="real-battery-label" x="40" y="45" text-anchor="middle" font-size="16">9V</text>
            <circle class="real-battery-terminal" cx="20" cy="-10" r="8" />
            <circle class="real-battery-terminal" cx="60" cy="-10" r="8" />
            <text class="component-label" x="15" y="-18" font-size="12">+</text>
            <text class="component-label" x="55" y="-18" font-size="12">-</text>
          </g>

          <g transform="translate(320, 85)">
            <line class="real-resistor-lead" x1="0" y1="15" x2="20" y2="15" />
            <line class="real-resistor-lead" x1="210" y1="15" x2="230" y2="15" />
            <rect class="real-resistor-body" x="20" y="0" width="190" height="30" rx="15" />
            <line class="real-resistor-band" x1="50" y1="0" x2="50" y2="30" stroke="#8b4513" />
            <line class="real-resistor-band" x1="80" y1="0" x2="80" y2="30" stroke="#ff0000" />
            <line class="real-resistor-band" x1="110" y1="0" x2="110" y2="30" stroke="#000000" />
            <line class="real-resistor-band" x1="160" y1="0" x2="160" y2="30" stroke="#ffd700" />
            <text class="component-label" x="115" y="50" text-anchor="middle" font-size="14">Resistor</text>
          </g>

          <g transform="translate(400, 460)">
            <circle id="bulb-glow-effect" cx="0" cy="0" r="0" fill="url(#bulb-glow)" opacity="0"/>
            <ellipse cx="0" cy="-10" rx="30" ry="35" fill="rgba(230, 230, 250, 0.3)" stroke="#c0c0c0" stroke-width="2.5"/>
            <path id="bulb-filament" d="M -12 -5 Q -8 -15, 0 -20 Q 8 -15, 12 -5" stroke="#888" stroke-width="2" fill="none"/>
            <path d="M -12 -5 Q -8 5, 0 10 Q 8 5, 12 -5" stroke="#888" stroke-width="2" fill="none"/>
            <rect x="-15" y="20" width="30" height="25" rx="3" fill="#c0c0c0" stroke="#888" stroke-width="1.5"/>
            <line x1="-15" y1="25" x2="15" y2="25" stroke="#666" stroke-width="1"/>
            <line x1="-15" y1="30" x2="15" y2="30" stroke="#666" stroke-width="1"/>
            <line x1="-15" y1="35" x2="15" y2="35" stroke="#666" stroke-width="1"/>
            <line x1="-15" y1="40" x2="15" y2="40" stroke="#666" stroke-width="1"/>
            <circle cx="0" cy="47" r="8" fill="#888" stroke="#666" stroke-width="1"/>
            <text class="component-label" x="0" y="70" text-anchor="middle" font-size="14">Light Bulb</text>
          </g>

          <g id="switch-component" transform="translate(760, 140)" style="cursor: pointer;">
            <rect class="real-switch-body" x="0" y="0" width="80" height="120" rx="8" />
            <circle class="real-switch-terminal" cx="40" cy="10" r="6" />
            <circle class="real-switch-terminal" cx="40" cy="110" r="6" />
            <rect id="switch-line" class="real-switch-lever" x="30" y="35" width="20" height="50" rx="10" fill="#4caf50" stroke="#2e7d32" stroke-width="2"/>
            <text class="component-label" x="40" y="-10" text-anchor="middle" font-size="14" id="switch-label">ON</text>
          </g>

          <g id="electron-container"></g>
        `;
      } else {
        svg.innerHTML = `
          <defs>
            <path id="electron-path" d="M 100 320 L 100 400 L 350 400 L 350 440 L 450 440 L 450 400 L 800 400 L 800 250 L 800 200 L 800 100 L 520 100 L 380 100 L 100 100 L 100 180 Z" />
            <radialGradient id="bulb-glow">
              <stop offset="0%" style="stop-color:#ffeb3b;stop-opacity:0.9" />
              <stop offset="50%" style="stop-color:#ffc107;stop-opacity:0.6" />
              <stop offset="100%" style="stop-color:#ff9800;stop-opacity:0" />
            </radialGradient>
          </defs>

          <line class="wire-line" x1="100" y1="400" x2="350" y2="400" />
          <line class="wire-line" x1="450" y1="400" x2="800" y2="400" />
          <line class="wire-line" x1="350" y1="400" x2="350" y2="440" />
          <line class="wire-line" x1="350" y1="440" x2="450" y2="440" />
          <line class="wire-line" x1="450" y1="440" x2="450" y2="400" />
          <line class="wire-line" x1="800" y1="400" x2="800" y2="250" />
          <line class="wire-line" x1="800" y1="200" x2="800" y2="100" />
          <line class="wire-line" x1="800" y1="100" x2="100" y2="100" />
          <line class="wire-line" x1="100" y1="100" x2="100" y2="180" />
          <line class="wire-line" x1="100" y1="320" x2="100" y2="400" />

          <g transform="translate(80, 180)">
            <rect class="battery-box" x="0" y="0" width="40" height="140" />
            <line class="battery-pos" x1="-10" y1="30" x2="50" y2="30" />
            <line class="battery-neg" x1="-10" y1="110" x2="50" y2="110" />
            <text class="component-label" x="55" y="75" font-size="24">V</text>
          </g>

          <g transform="translate(380, 75)">
            <rect class="resistor-rect" x="0" y="0" width="140" height="50" rx="5" />
            <path class="resistor-zigzag" d="M 18 25 L 32 12 L 50 38 L 68 12 L 86 38 L 104 12 L 122 25" stroke-width="4" />
            <text class="component-label" x="70" y="75" text-anchor="middle" font-size="24">R</text>
          </g>

          <g transform="translate(400, 440)">
            <circle id="bulb-glow-effect" cx="0" cy="0" r="0" fill="url(#bulb-glow)" opacity="0"/>
            <circle cx="0" cy="0" r="35" fill="none" stroke="#e8eef7" stroke-width="2.5"/>
            <path id="bulb-filament" d="M -15 -8 L -8 -8 L -5 0 L 0 -8 L 5 0 L 8 -8 L 15 -8" stroke="#5a7aa0" stroke-width="2.5" fill="none"/>
            <rect x="-12" y="30" width="24" height="15" fill="#5a7aa0" stroke="#e8eef7" stroke-width="2"/>
            <line x1="-12" y1="35" x2="12" y2="35" stroke="#e8eef7" stroke-width="1"/>
            <line x1="-12" y1="40" x2="12" y2="40" stroke="#e8eef7" stroke-width="1"/>
            <text class="component-label" x="0" y="65" text-anchor="middle" font-size="20">BULB</text>
          </g>

          <g id="switch-component" transform="translate(780, 200)" style="cursor: pointer;">
            <circle cx="20" cy="50" r="12" fill="#2d3a52" stroke="#e8eef7" stroke-width="2"/>
            <circle cx="20" cy="-50" r="12" fill="#2d3a52" stroke="#e8eef7" stroke-width="2"/>
            <line id="switch-line" x1="20" y1="-50" x2="20" y2="50" stroke="#00d9ff" stroke-width="4" stroke-linecap="round"/>
            <text class="component-label" x="45" y="5" font-size="20" id="switch-label">ON</text>
          </g>

          <g id="electron-container"></g>
        `;
      }

      // Attach click handler to switch
      const switchEl = document.getElementById('switch-component');
      if (switchEl) {
        switchEl.onclick = toggleSwitch;
      }

      updateSwitchVisual();
      createElectrons();
    }

    function toggleMode() {
      isRealMode = !isRealMode;
      const modeIcon = document.getElementById('mode-icon');
      const modeText = document.getElementById('mode-text');
      
      if (isRealMode) {
        modeIcon.textContent = 'üìê';
        modeText.textContent = 'Schematic Mode';
      } else {
        modeIcon.textContent = 'üîß';
        modeText.textContent = 'Real Objects Mode';
      }
      
      console.log('Mode switched to:', isRealMode ? 'Real' : 'Schematic');
      renderCircuit();
    }

    function updateSwitchVisual() {
      const switchLabel = document.getElementById('switch-label');
      
      if (isRealMode) {
        const switchRect = document.getElementById('switch-line');
        if (switchRect) {
          if (circuitOn) {
            switchRect.setAttribute('y', '35');
            switchRect.setAttribute('fill', '#4caf50');
            switchRect.setAttribute('stroke', '#2e7d32');
          } else {
            switchRect.setAttribute('y', '15');
            switchRect.setAttribute('fill', '#ff5252');
            switchRect.setAttribute('stroke', '#c62828');
          }
        }
      } else {
        const switchLine = document.getElementById('switch-line');
        if (switchLine) {
          if (circuitOn) {
            switchLine.setAttribute('x1', '20');
            switchLine.setAttribute('y1', '-50');
            switchLine.setAttribute('x2', '20');
            switchLine.setAttribute('y2', '50');
            switchLine.setAttribute('stroke', '#00d9ff');
          } else {
            switchLine.setAttribute('x1', '20');
            switchLine.setAttribute('y1', '-50');
            switchLine.setAttribute('x2', '35');
            switchLine.setAttribute('y2', '-20');
            switchLine.setAttribute('stroke', '#ff4444');
          }
        }
      }
      
      if (switchLabel) {
        switchLabel.textContent = circuitOn ? 'ON' : 'OFF';
        switchLabel.setAttribute('fill', circuitOn ? '#00d9ff' : '#ff4444');
      }
      
      updateBulbGlow();
    }

    function updateBulbGlow() {
      const bulbGlow = document.getElementById('bulb-glow-effect');
      const bulbFilament = document.getElementById('bulb-filament');
      
      if (!bulbGlow) return;
      
      if (circuitOn) {
        bulbGlow.setAttribute('r', '80');
        bulbGlow.setAttribute('opacity', '1');
        if (bulbFilament) {
          bulbFilament.setAttribute('stroke', '#ffeb3b');
          bulbFilament.setAttribute('filter', 'drop-shadow(0 0 8px rgba(255, 235, 59, 1))');
        }
      } else {
        bulbGlow.setAttribute('r', '0');
        bulbGlow.setAttribute('opacity', '0');
        if (bulbFilament) {
          bulbFilament.setAttribute('stroke', isRealMode ? '#888' : '#5a7aa0');
          bulbFilament.setAttribute('filter', 'none');
        }
      }
    }

    function toggleSwitch() {
      circuitOn = !circuitOn;
      updateSwitchVisual();
      createElectrons();
    }

    function createElectrons() {
      const container = document.getElementById('electron-container');
      if (!container) return;
      
      container.innerHTML = '';

      if (!circuitOn) return;

      const duration = getElectronSpeed();

      for (let i = 0; i < electronCount; i++) {
        const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
        circle.setAttribute('class', 'electron-dot');
        circle.setAttribute('r', '6');
        circle.setAttribute('cx', '0');
        circle.setAttribute('cy', '0');

        const animateMotion = document.createElementNS('http://www.w3.org/2000/svg', 'animateMotion');
        animateMotion.setAttribute('dur', `${duration}s`);
        animateMotion.setAttribute('repeatCount', 'indefinite');
        animateMotion.setAttribute('begin', `${(i / electronCount) * duration}s`);

        const mpath = document.createElementNS('http://www.w3.org/2000/svg', 'mpath');
        mpath.setAttributeNS('http://www.w3.org/1999/xlink', 'href', '#electron-path');

        animateMotion.appendChild(mpath);
        circle.appendChild(animateMotion);
        container.appendChild(circle);
      }
    }

    function updateSimulation() {
      updateDisplayValues();
      createElectrons();
    }

    document.getElementById('voltage-slider').addEventListener('input', (e) => {
      voltage = parseFloat(e.target.value);
      updateSimulation();
    });

    document.getElementById('resistance-slider').addEventListener('input', (e) => {
      resistance = parseFloat(e.target.value);
      updateSimulation();
    });

    document.getElementById('mode-toggle').addEventListener('click', toggleMode);

    let isContentVisible = true;

    function toggleVisibility() {
      isContentVisible = !isContentVisible;
      const visibilityText = document.getElementById('visibility-text');
      const sections = ['simulator-section', 'controls-section', 'discussion-sections'];
      
      sections.forEach(sectionId => {
        const section = document.getElementById(sectionId);
        if (section) {
          if (isContentVisible) {
            section.classList.remove('collapsed');
          } else {
            section.classList.add('collapsed');
          }
        }
      });
      
      visibilityText.textContent = isContentVisible ? 'Hide All' : 'Show All';
    }

    document.getElementById('visibility-toggle').addEventListener('click', toggleVisibility);

    async function onConfigChange(config) {
      document.getElementById('page-title').textContent = config.page_title || defaultConfig.page_title;
      document.getElementById('caption-text').textContent = config.caption_text || defaultConfig.caption_text;
      document.getElementById('voltage-label').textContent = config.voltage_label_text || defaultConfig.voltage_label_text;
      document.getElementById('resistance-label').textContent = config.resistance_label_text || defaultConfig.resistance_label_text;

      const bgColor = config.background_color || defaultConfig.background_color;
      document.body.style.background = `linear-gradient(135deg, ${bgColor} 0%, #0b0f2a 50%, #060a18 100%)`;
    }

    function mapToCapabilities(config) {
      return {
        recolorables: [
          {
            get: () => config.background_color || defaultConfig.background_color,
            set: (value) => {
              window.elementSdk.config.background_color = value;
              window.elementSdk.setConfig({ background_color: value });
            }
          },
          {
            get: () => config.primary_accent_color || defaultConfig.primary_accent_color,
            set: (value) => {
              window.elementSdk.config.primary_accent_color = value;
              window.elementSdk.setConfig({ primary_accent_color: value });
            }
          },
          {
            get: () => config.wire_color || defaultConfig.wire_color,
            set: (value) => {
              window.elementSdk.config.wire_color = value;
              window.elementSdk.setConfig({ wire_color: value });
            }
          },
          {
            get: () => config.text_color || defaultConfig.text_color,
            set: (value) => {
              window.elementSdk.config.text_color = value;
              window.elementSdk.setConfig({ text_color: value });
            }
          },
          {
            get: () => config.secondary_text_color || defaultConfig.secondary_text_color,
            set: (value) => {
              window.elementSdk.config.secondary_text_color = value;
              window.elementSdk.setConfig({ secondary_text_color: value });
            }
          }
        ],
        borderables: [],
        fontEditable: undefined,
        fontSizeable: undefined
      };
    }

    function mapToEditPanelValues(config) {
      return new Map([
        ["page_title", config.page_title || defaultConfig.page_title],
        ["caption_text", config.caption_text || defaultConfig.caption_text],
        ["voltage_label_text", config.voltage_label_text || defaultConfig.voltage_label_text],
        ["resistance_label_text", config.resistance_label_text || defaultConfig.resistance_label_text]
      ]);
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities,
        mapToEditPanelValues
      });
    }

    // Initialize
    renderCircuit();
    updateSimulation();

    function toggleSection(sectionId) {
      const content = document.getElementById(sectionId);
      const icon = document.getElementById('icon-' + sectionId);
      
      if (content.style.display === 'none') {
        content.style.display = 'block';
        icon.classList.add('rotated');
      } else {
        content.style.display = 'none';
        icon.classList.remove('rotated');
      }
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9c46c35e94222b7b',t:'MTc2OTUwMTMxNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>